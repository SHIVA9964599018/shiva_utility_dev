<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shiva Utility Hub</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4CAF50">
  <link rel="icon" href="icons/icon-192.png" type="image/png">
</head>
<body>

  <!-- Navigation Bar -->
  <nav>
    <a href="#" onclick="showUtilitySubSection('utility-add-dish')">Add Dish</a>
    <a href="#" onclick="promptCalorieLogin()">Daily Calorie</a>
    <a href="#" onclick="showUtilitySubSection('utility-food-facts'); loadFoodFacts();">All Food Facts</a>
	<a href="#" onclick="showUtilitySubSection('utility-weight-tracker')">Weight Tracker</a>
  </nav>

  <!-- Install Prompt -->
  <p style="font-weight: bold; font-size: 1.1em; margin-top: 20px; padding-left: 20px;">
    ðŸ“² Install this app for a better experience!
  </p>
  <button id="installApp" style="display: none;">ðŸ“² Install App</button>

  <!-- Welcome Message -->
  <div class="welcome-message" id="welcome-message" style="display: none;"></div>

  <!-- Vision Message -->
  <div class="vision-message">
    I am building this website with love for my family and friends to become more aware of their eating habits and the calorie values of what they eat â€” to help them lead a healthier, more informed life.
  </div>


  <!-- Utilities Section -->
  <section id="utilities" style="padding:20px;">
    <!-- Add Dish Section -->
    <div id="utility-add-dish" style="display:none;">
      <h3>Add Dish Nutrition Info</h3>
      <form id="nutrition-form" class="nutrition-form">
        <label>Dish Name: <input type="text" id="dish_name" required></label>
        <label>Calories (per 100gm): <input type="number" id="calorie" step="any" required></label>
        <label>Protein (per 100gm): <input type="number" id="protein" step="any" required></label>
        <label>Carbs (per 100gm): <input type="number" id="carbs" step="any" required></label>
        <label>Fibre (per 100gm): <input type="number" id="fibre" step="any" required></label>
        <label>Fats (per 100gm): <input type="number" id="fats" step="any" required></label>
        <button type="submit">Save Dish</button>
      </form>
      <p id="nutrition-message" style="margin-top: 20px;"></p>
    </div>
	<div id="utility-daily-calorie" style="display: none;">
	 <div class="calorie-wrapper">
		<h3 class="calorie-heading">Daily Calorie Calculator</h3>

		<div class="meal-sections">
		  <!-- Breakfast -->
			<details open>
			  <summary>
				<div class="meal-header">
				  <strong>Breakfast</strong>
				  <button onclick="addDishRow('breakfast')" class="add-btn-inline">+ Add</button>
				</div>
			  </summary>
			  <div id="breakfast-container"></div>
			</details>

			<!-- Lunch -->
			<details open>
			  <summary>
				<div class="meal-header">
				  <strong>Lunch</strong>
				  <button onclick="addDishRow('lunch')" class="add-btn-inline">+ Add</button>
				</div>
			  </summary>
			  <div id="lunch-container"></div>
			</details>

			<!-- Dinner -->
			<details open>
			  <summary>
				<div class="meal-header">
				  <strong>Dinner</strong>
				  <button onclick="addDishRow('dinner')" class="add-btn-inline">+ Add</button>
				</div>
			  </summary>
			  <div id="dinner-container"></div>
			</details>
		</div>

		<button id="calculate-btn">Calculate</button>
		<div id="calorie-result" style="margin-top: 20px;"></div>
	  </div>
	</div>


<div id="summary-container" style="display: none; margin-top: 30px;">
  <details id="summary-toggle">
    <summary style="font-size: 1.2rem; font-weight: bold; cursor: pointer;">
       Dish Summary (click to expand)
    </summary>

    <div class="table-scroll-wrapper" style="margin-top: 10px;">
      <table class="summary-table" style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr style="background-color: #f0f0f0;">
            <th style="padding: 6px; border: 1px solid #ccc;">Dish Name</th>
            <th style="padding: 6px; border: 1px solid #ccc;">Quantity (gm)</th>
            <th style="padding: 6px; border: 1px solid #ccc;">Calories</th>
            <th style="padding: 6px; border: 1px solid #ccc;">Protein</th>
            <th style="padding: 6px; border: 1px solid #ccc;">Fibre</th>
            <th style="padding: 6px; border: 1px solid #ccc;">Carbs</th>
            <th style="padding: 6px; border: 1px solid #ccc;">Fats</th>
          </tr>
        </thead>
        <tbody id="dish-summary-body"></tbody>
      </table>
    </div>
  </details>
</div>




	<!-- Results will appear here -->

	<div id="utility-food-facts" style="display:none;">
	<div class="table-scroll-wrapper">
    <!-- All Food Facts Section -->
      <h3>All Food Facts</h3>
      <div id="food-facts-table-container">
        <table id="food-facts-table" class="sortable" border="1" cellspacing="0" cellpadding="6">
          <thead>
            <tr><th>Dish Name</th><th>Cal/100g</th><th>Protein</th><th>Fibre</th><th>Carbs</th><th>Fats</th></tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
	</div>
	<!-- weight tracker -->
	<div id="utility-weight-tracker" style="display:none;">
	  <h3>Weight Tracker</h3>
	  <form id="weight-upload-form">
		<input type="file" accept="image/*" id="weight-image" />
		<br>
		<label>Date: <input type="date" id="weight-date" required></label>
		<label>Weight (kg): <input type="number" id="weight-value" step="0.1" required></label>
		<button type="submit">Upload Entry</button>
	  </form>
	  <div id="weight-timeline" style="margin-top:20px;">
		<h4>Progress Timeline</h4>
		<ul id="timeline-list" style="list-style-type: none; padding-left: 0;"></ul>
	  </div>
	</div>

	
  </section>



  <!-- Login Modal -->
  <div id="loginModal" style="display:none; position:fixed; top:30%; left:50%; transform:translate(-50%, -50%); background:#fff; padding:20px; border:1px solid #ccc; box-shadow:0 2px 10px rgba(0,0,0,0.2); z-index:9999;">
    <h3>Login to access Calorie Tracker</h3>
    <input type="text" id="usernameInput" placeholder="Username"><br><br>
    <input type="password" id="passwordInput" placeholder="Password"><br><br>
    <button onclick="handleCalorieLogin()">Login</button>
  </div>

  <!-- Script Dependencies -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script src="https://www.kryogenix.org/code/browser/sorttable/sorttable.js"></script>
  <script type="module" src="script.js"></script>

  <!-- Inline to show welcome message -->
<script>
  window.onload = () => {
    const userId = localStorage.getItem("user_id");
    if (userId) {
      const welcomeDiv = document.getElementById("welcome-message");
      if (welcomeDiv) {
        welcomeDiv.textContent = `Welcome, ${userId}!`;
        welcomeDiv.style.display = "block";
      }
    }
  };
</script>
</body>
</html>
